<!DOCTYPE html>
<html>
    <head>
        <title>Super8</title>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <style>
            canvas{
                width: 100%;
                height: 100%;
            }
            
            body{
                margin: 0px;
                overflow: hidden;
            }
        </style>
        
    </head>
    <body>
        
        <script src="three.min.js"></script>
        <script src="PointerLockControls.js"></script>
        <script src="controls.js"></script>
        <script>
            //SCENE
            var scene = new THREE.Scene();
            //scene.fog = new THREE.Fog(0xffffff, 0, 25);
            
            //CAMERA
            var camera = new THREE.PerspectiveCamera(45, window.innerWidth / window.innerHeight, 0.1, 1000); //Perspective(field of view, aspect ratio, near, far)
            camera.position.z = 20;
            camera.position.y = 0.5;
            camera.position.x = 1;
            
            //CONTROLS
            controls = new THREE.OrbitControls(camera);
            
            //LIGHTS
                //DIRECTIONAL LIGHT
                var directionalLight = new THREE.DirectionalLight("white");
                directionalLight.position.set(20,20,20);
                directionalLight.target.position.set(0,0,0);
                directionalLight.castShadow = true;
                directionalLight.shadowDarkness = 0.5;

                directionalLight.shadowCameraNear = 0;
                directionalLight.shadowCameraFar = 50;

                directionalLight.shadowCameraLeft = -30;
                directionalLight.shadowCameraRight = 30;
                directionalLight.shadowCameraTop = 30;
                directionalLight.shadowCameraBottom = -30;

                directionalLight.shadowCameraVisible = true;
                
                directionalLight.shadowMapWidth = 2048;
                directionalLight.shadowMapHeight = 2048;
                scene.add(directionalLight);

                //HEMISPHERE LIGHT
                var hemiLight = new THREE.HemisphereLight(0xffffff, 0.1);
                hemiLight.position.y = 20;
                scene.add(hemiLight);


            //RENDERER
            var renderer = new THREE.WebGLRenderer({antialias: true});
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.shadowMapEnabled = true;
            renderer.shadowMapSoft = true;
            renderer.shadowMapType = THREE.PCFSoftShadowMap;
            document.body.appendChild(renderer.domElement);


            //GEOMETRY
                //SKYBOX
                var imagePrefix = "textures/skybox/";
                var directions  = ["xpos", "xneg", "ypos", "yneg", "zpos", "zneg"];
                var imageSuffix = ".jpg";

                var materialArray = [];
                for (var i = 0; i < 6; i++){
                    materialArray.push( new THREE.MeshBasicMaterial({map: THREE.ImageUtils.loadTexture( imagePrefix + directions[i] + imageSuffix ), side: THREE.BackSide}));
                }
                var skyGeometry = new THREE.CubeGeometry(100,50,100);
                var skyMaterial = new THREE.MeshFaceMaterial( materialArray );
                var skyBox = new THREE.Mesh( skyGeometry, skyMaterial );
                skyBox.position.y = 20;
                scene.add(skyBox);                
            
                //HOUSE
                var house_geometry = new THREE.CubeGeometry(10,2.5,5);
                var house_material = new THREE.MeshPhongMaterial({color: "grey"});            
                var house = new THREE.Mesh(house_geometry, house_material);
                house.position.y = + 1.25;
                house.castShadow = true;
                scene.add(house);


                //GROUND
                    //GRASS
                    var grass_geometry = new THREE.PlaneGeometry(12.5, 12.5);
                    var grass_material = new THREE.MeshPhongMaterial({map: THREE.ImageUtils.loadTexture("textures/ground/grass.jpg")});
                
                    //BLOCK A
                    var grass_01 = new THREE.Mesh(grass_geometry, grass_material);
                    grass_01.position.set(-18.75, 0, -18.75);
                    grass_01.rotateX(-Math.PI/2);
                    grass_01.receiveShadow = true;
                    scene.add(grass_01);
                    
                    var grass_02 = new THREE.Mesh(grass_geometry, grass_material);
                    grass_02.position.set(-6.25, 0, -18.75);
                    grass_02.rotateX(-Math.PI/2);
                    grass_02.receiveShadow = true;
                    scene.add(grass_02);
                    
                    var grass_03 = new THREE.Mesh(grass_geometry, grass_material);
                    grass_03.position.set(-18.75, 0, -6.25);
                    grass_03.rotateX(-Math.PI/2);
                    grass_03.receiveShadow = true;
                    scene.add(grass_03);
                    
                    var grass_04 = new THREE.Mesh(grass_geometry, grass_material);
                    grass_04.position.set(-6.25, 0, -6.25);
                    grass_04.rotateX(-Math.PI/2);
                    grass_04.receiveShadow = true;
                    scene.add(grass_04);
                    
                    //BLOCK B
                    var grass_05 = new THREE.Mesh(grass_geometry, grass_material);
                    grass_05.position.set(6.25, 0, -18.75);
                    grass_05.rotateX(-Math.PI/2);
                    grass_05.receiveShadow = true;
                    scene.add(grass_05);
                    
                    var grass_06 = new THREE.Mesh(grass_geometry, grass_material);
                    grass_06.position.set(18.75, 0, -18.75);
                    grass_06.rotateX(-Math.PI/2);
                    grass_06.receiveShadow = true;
                    scene.add(grass_06);
                    
                    var grass_07 = new THREE.Mesh(grass_geometry, grass_material);
                    grass_07.position.set(6.25, 0, -6.25);
                    grass_07.rotateX(-Math.PI/2);
                    grass_07.receiveShadow = true;
                    scene.add(grass_07);
                    
                    var grass_08 = new THREE.Mesh(grass_geometry, grass_material);
                    grass_08.position.set(18.75, 0, -6.25);
                    grass_08.rotateX(-Math.PI/2);
                    grass_08.receiveShadow = true;
                    scene.add(grass_08);
                    
                    //BLOCK C
                    var grass_09 = new THREE.Mesh(grass_geometry, grass_material);
                    grass_09.position.set(-18.75, 0, 6.25);
                    grass_09.rotateX(-Math.PI/2);
                    grass_09.receiveShadow = true;
                    scene.add(grass_09);
                    
                    var grass_10 = new THREE.Mesh(grass_geometry, grass_material);
                    grass_10.position.set(-6.25, 0, 6.25);
                    grass_10.rotateX(-Math.PI/2);
                    grass_10.receiveShadow = true;
                    scene.add(grass_10);
                    
                    var grass_11 = new THREE.Mesh(grass_geometry, grass_material);
                    grass_11.position.set(-18.75, 0, 18.75);
                    grass_11.rotateX(-Math.PI/2);
                    grass_11.receiveShadow = true;
                    scene.add(grass_11);
                    
                    var grass_12 = new THREE.Mesh(grass_geometry, grass_material);
                    grass_12.position.set(-6.25, 0, 18.75);
                    grass_12.rotateX(-Math.PI/2);
                    grass_12.receiveShadow = true;
                    scene.add(grass_12);
                    
                    //BLOCK D
                    var grass_13 = new THREE.Mesh(grass_geometry, grass_material);
                    grass_13.position.set(6.25, 0, 6.25);
                    grass_13.rotateX(-Math.PI/2);
                    grass_13.receiveShadow = true;
                    scene.add(grass_13);
                    
                    var grass_14 = new THREE.Mesh(grass_geometry, grass_material);
                    grass_14.position.set(18.75, 0, 6.25);
                    grass_14.rotateX(-Math.PI/2);
                    grass_14.receiveShadow = true;
                    scene.add(grass_14);
                    
                    var grass_15 = new THREE.Mesh(grass_geometry, grass_material);
                    grass_15.position.set(6.25, 0, 18.75);
                    grass_15.rotateX(-Math.PI/2);
                    grass_15.receiveShadow = true;
                    scene.add(grass_15);
                    
                    var grass_16 = new THREE.Mesh(grass_geometry, grass_material);
                    grass_16.position.set(18.75, 0, 18.75);
                    grass_16.rotateX(-Math.PI/2);
                    grass_16.receiveShadow = true;
                    scene.add(grass_16);
            
            //FUNCTION
            function render(){            
                renderer.render(scene,camera);
                requestAnimationFrame(render);
    
                // Controls
                //document.addEventListener('keypress', checkKeys, false );
              
            }





            // Controls 2.0 – Pointer Lock Controls
           
            
            
             // CONTROLS
            function checkKeys(event){
            // Key-Numbers: http://help.adobe.com/en_US/AS2LCR/Flash_10.0/help.html?content=00000520.html
                
                event = event || window.event;
                //var keyCode = event.which;
                var pos = 0.4; // movement
                var rot = 0.1; // rotation
                
                // Position
                // W-Key :: Up
                if (event.charCode === 119){
                    camera.position.z -= pos;
                    //camera.position.y += 0.1;
                    //camera.position.y -= 0.1;
                }
                
                // S-Key – Down
                else if (event.charCode === 115){
                    camera.position.z += pos;
                }
               
                // A-Key – Left
                else if (event.charCode === 97){
                    camera.position.x -= pos;
                }
                
                // D-Key – Right
                else if(event.charCode === 100){
                    camera.position.x += pos;
                }
                
                
                // Rotation
                // Arrow up - Rotate up
                else if (event.keyCode === 38){ 
                    camera.rotation.x += rot;
                } 
                
                // Arrow down - Rotate down
                else if(event.keyCode === 40){ 
                    camera.rotation.x -= rot; 
                } 
                
                // Arrow left 
                else if(event.keyCode === 37){ 
                    camera.rotation.y += rot; 
                } 
                
                // Arrow right 
                else if(event.keyCode === 39){ 
                    camera.rotation.y -= rot; 
                }

            }
           


            render();
        </script>
        
    </body>
</html>
